<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NucFlag Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fafafa;
            color: #333;
        }
        
        .container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            margin-top: 35px;
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 4px solid #3498db;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .intro {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }
        
        .workflow-list {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .workflow-item {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #27ae60;
        }
        
        .workflow-item strong {
            color: #2c3e50;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid #e74c3c;
        }
        
        .annotation-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .annotation-category {
            margin-bottom: 20px;
        }
        
        .annotation-category h4 {
            color: #000000;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .annotation-list {
            margin-left: 20px;
        }
        
        .annotation-list li {
            margin-bottom: 5px;
        }
        
        .note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        a {
            color: #3498db;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        .highlight {
            background: #dff0d8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .error-types {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .error-type {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #e74c3c;
        }
        
        .error-type h4 {
            color: #e74c3c;
            margin-bottom: 10px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 1em;
        }
        
        .error-type ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        .error-type li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>NucFlag</h1>
        
        <h2>Description</h2>
        <p>Missassembly identification using HiFi reads aligned to the assembly.</p>
        
        <p>NucFlag identifies the following assembly errors:</p>
        
        <div class="error-types">
            <div class="error-type">
                <h4>MISJOIN</h4>
                <ul>
                    <li>Drop in first most common base coverage or a coverage gap.</li>
                    <li>This region has minimal to no reads supporting it or is a scaffold.</li>
                    <li>Can overlap region with secondary base coverage.</li>
                </ul>
            </div>
            
            <div class="error-type">
                <h4>COLLAPSE</h4>
                <ul>
                    <li>Collapse with no variants.</li>
                </ul>
            </div>
            
            <div class="error-type">
                <h4>COLLAPSE_VAR</h4>
                <ul>
                    <li>Collapse with variants. Overlaps region with high secondary base coverage.</li>
                </ul>
            </div>
            
            <div class="error-type">
                <h4>COLLAPSE_OTHER</h4>
                <ul>
                    <li>Region with high het ratio.</li>
                </ul>
            </div>
            
            <div class="error-type">
                <h4>HET</h4>
                <ul>
                    <li>Possible heterozygous (het) site.</li>
                    <li>Determined by the het ratio, the coverage of the second most common base divided by the first most common base coverage plus the second most common base coverage.</li>
                </ul>
            </div>
        </div>
        
        <h2>Methods</h2>
        <p><a href="https://github.com/logsdon-lab/NucFlag">NucFlag</a> takes sample-matched HiFi reads that are aligned to an assembly and identifies potential assembly errors based on the presence of secondary bases in the alignment (when there should be none). It also detects missasemblies based on coverage information and finding spurious looking variants. Note that NucFlag was initially designed and tested for use in centromeres, but should in principal work in other regions of the genome if mapping to those regions can be trusted and the coverage is over 20X.</p>
        
        <p>HiFi bams from Flagger were used as inputs. For more information about how NucFlag was run for the HPRC see <a href="https://github.com/koisland/Snakemake-NucFlag-HPRC/blob/main/README.md">here</a>.</p>
        
        <h2>Contact</h2>
        <p>For inquiries, please contact:</p>
        <p><a href="mailto:oshimak@pennmedicine.upenn.edu">Keith Oshima &lt;oshimak@pennmedicine.upenn.edu&gt;</a></p>
        <p><a href="mailto:glogsdon@pennmedicine.upenn.edu">Glennis A. Logsdon &lt;glogsdon@pennmedicine.upenn.edu&gt;</a></p>
        
        <h2>Credits</h2>
        <p>Keith Oshima (Department of Genetics, Epigenetics Institute, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA, USA)</p>
        <p>Glennis A. Logsdon (Department of Genetics, Epigenetics Institute, Perelman School of Medicine, University of Pennsylvania, Philadelphia, PA, USA)</p>
    </div>
</body>
</html>