<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flagger-HiFi Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fafafa;
            color: #333;
        }
        
        .container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            margin-top: 35px;
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 4px solid #3498db;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .intro {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }
        
        .workflow-list {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .workflow-item {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #27ae60;
        }
        
        .workflow-item strong {
            color: #2c3e50;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid #e74c3c;
        }
        
        .annotation-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .annotation-category {
            margin-bottom: 20px;
        }
        
        .annotation-category h4 {
            color: #000000;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .annotation-list {
            margin-left: 20px;
        }
        
        .annotation-list li {
            margin-bottom: 5px;
        }
        
        .note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        a {
            color: #3498db;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        .highlight {
            background: #dff0d8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .component-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .component-table th {
            background: #34495e;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .component-table td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .component-table tr:last-child td {
            border-bottom: none;
        }
        
        .component-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .status-red {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .status-orange {
            color: #f39c12;
            font-weight: bold;
        }
        
        .status-green {
            color: #27ae60;
            font-weight: bold;
        }
        
        .status-purple {
            color: #8e44ad;
            font-weight: bold;
        }
        
        .color-red {
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        
        .color-orange {
            background: #f39c12;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        
        .color-green {
            background: #27ae60;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        
        .color-purple {
            background: #8e44ad;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Flagger-HiFi</h1>
        
        <h2>Description</h2>
        <p><a href="https://github.com/mobinasri/flagger">HMM-Flagger</a> is a read-mapping-based tool that can detect different types of mis-assemblies in a dual or diploid genome assembly.</p>
        
        <table class="component-table">
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Status</th>
                    <th>Color</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Err</strong></td>
                    <td><span class="status-red">Erroneous</span></td>
                    <td><span class="color-red">Red</span></td>
                    <td>This block has low read coverage. If it is located in the middle of a contig it could be either a misjoin or a region that needs polishing</td>
                </tr>
                <tr>
                    <td><strong>Dup</strong></td>
                    <td><span class="status-orange">Duplicated</span></td>
                    <td><span class="color-orange">Orange</span></td>
                    <td>This block is potentially a false duplication of another block. It should mainly include low-MAPQ alignments with half of the expected coverage. Probably one of the copies has to be polished or removed to fix this issue</td>
                </tr>
                <tr>
                    <td><strong>Hap</strong></td>
                    <td><span class="status-green">Haploid</span></td>
                    <td><span class="color-green">Green</span></td>
                    <td>This block is correctly assembled and has the expected read coverage</td>
                </tr>
                <tr>
                    <td><strong>Col</strong></td>
                    <td><span class="status-purple">Collapsed</span></td>
                    <td><span class="color-purple">Purple</span></td>
                    <td>Two or more highly similar haplotypes are collapsed into this block</td>
                </tr>
            </tbody>
        </table>
        
        <h2>Methods</h2>
        <p>HMM-Flagger receives the read alignments to a genome assembly, uses Hidden Markov Model to detect anomalies in the read coverage along the assembly and finally partitions the assembly into four classes; erroneous, falsely duplicated, haploid (structurally correct) and collapsed. The HPRC Release 2 assemblies were run using WDL launches with <a href="https://github.com/DataBiosphere/toil">TOIL</a>.</p>
        
        <h2>References</h2>
        <p>Liao, Wen-Wei, Mobin Asri, Jana Ebler, Daniel Doerr, Marina Haukness, Glenn Hickey, Shuangjia Lu et al. "A draft human pangenome reference." Nature 617, no. 7960 (2023): 312-324.</p>
        
        <h2>Contact</h2>
        For inquiries, please contact:
        <p><a href="mailto:masri@ucsc.edu">Mobin Asri &lt;masri@ucsc.edu&gt;</a></p>
        <p><a href="mailto:bpaten@ucsc.edu">Benedict Paten &lt;bpaten@ucsc.edu&gt;</a></p>

        <h2>Credits</h2>
        <p>Mobin Asri (UC Santa Cruz Genomics Institute, University of California, Santa Cruz, Santa Cruz, CA, USA)</p>
        <p>Benedict Paten (UC Santa Cruz Genomics Institute, University of California, Santa Cruz, Santa Cruz, CA, USA)</p>
    </div>
</body>
</html>